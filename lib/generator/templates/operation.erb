<%= description %>
#
<% tags.each do |tag| -%>
<%= tag %>
<% end -%>
<%= method_definition %>
  <% if sandbox_rule -%>
  <%= sandbox_rule -%>
  <% end -%>
  path = "<%= path %>"
  <% if body_param_name && body_param_name != "body" -%>
  body = <%= body_param_name %>
  <% end -%>
  <% if query_params.any? -%>
  params = {
    <% query_params.each do |k, v| -%>
    "<%= k %>" => <%= v %>,
    <% end -%>
  }.compact
  <% end -%>
  <% if has_typed_response? -%>
  parser = -> {
    require "peddler/types/<%= api_name_with_version %>"
    Types::<%= parser_class_name %>
  }
  <% end -%>
  <% if rate_limit -%>
  meter(rate_limit).<%= verb %>(<%= request_args.join(", ") %><% if has_typed_response? -%>, parser:<% end -%>)
  <% else -%>
  <%= verb %>(<%= request_args.join(", ") %><% if has_typed_response? -%>, parser:<% end -%>)
  <% end -%>
end
