# frozen_string_literal: true

# <%= Generator::Config::GENERATED_FILE_NOTICE %>

<% if needs_money? -%>
require "peddler/types/money"
<% end -%>
<% if type_dependencies.empty? || uses_string_class_names? -%>
require "structure"
<% end -%>
<% type_dependencies.each do |dep| -%>
require "peddler/types/<%= api_name %>/<%= dep.underscore %>"
<% end -%>

module Peddler
  module Types
    module <%= api_name.camelize %>
      <% if class_description -%>
        <%= class_description %>
      <% end -%>
      <%= class_name %> = Structure.new do
        <% properties.each_with_index do |(prop_name, prop_def), index| -%>
          <%= "\n" if index > 0 -%>
          <%= format_property_comment(prop_def) %>
          <% if required_properties.include?(prop_name) -%>
          attribute(:<%= attribute_name_for(prop_name, prop_def) %>, <%= ruby_type_for(prop_def) %><% if attribute_name_for(prop_name, prop_def) != prop_name %>, from: "<%= prop_name %>"<% end %>)
          <% else -%>
          attribute?(:<%= attribute_name_for(prop_name, prop_def) %>, <%= ruby_type_for(prop_def) %><% if attribute_name_for(prop_name, prop_def) != prop_name %>, from: "<%= prop_name %>"<% end %>)
          <% end -%>
        <% end -%>
      end
    end
  end
end
